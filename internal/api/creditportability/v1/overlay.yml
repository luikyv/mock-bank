overlay: 1.0.0
info:
  title: Overlay
  version: 0.0.0
strict: false
actions:
- target: $.components.schemas[*].properties.meta
  description: Set x-go-type and x-go-type-import for all fields named "meta"
  update:
    x-go-type: api.Meta
    x-go-type-import:
      path: github.com/luikyv/mock-bank/internal/api
- target: $.components.schemas[*].properties.meta.$ref
  description: Remove $ref fields from meta properties to ensure the application of the custom x-go-type
  remove: true

- target: $.components.schemas[*].properties.links
  description: Set x-go-type and x-go-type-import for all fields named "links"
  update:
    x-go-type: api.Links
    x-go-type-import:
      path: github.com/luikyv/mock-bank/internal/api
- target: $.components.schemas[*].properties.links.$ref
  description: Remove $ref fields from links properties to ensure the application of the custom x-go-type
  remove: true

- target: $.components.schemas.ResponsePortabilityEligibility.properties.data.properties.portability.properties.statusUpdateDateTime
  update:
    format: date-time

- target: $.components.schemas.ResponsePortabilitiesByPortabilityId.properties.data.properties.statusUpdateDateTime
  update:
    format: date-time

- target: $.components.schemas.RequestCreditPortabilityPayment.properties.data.properties.paymentDateTime
  update:
    format: date-time

- target: $.components.schemas.POSTResponseCreditPortabilityPayment.properties.data.properties.paymentDateTime
  update:
    format: date-time

- target: $.components.schemas.ResponsePortabilitiesByPortabilityId.properties.data.properties.loanSettlementInstruction.properties.settlementDateTime
  update:
    format: date-time

- target: $..[*][?(@.format == "date")]
  update:
    x-go-type: timeutil.BrazilDate
    x-go-type-import:
      path: github.com/luikyv/mock-bank/internal/timeutil

- target: $..[*][?(@.format == "date-time")]
  update:
    x-go-type: timeutil.DateTime
    x-go-type-import:
      path: github.com/luikyv/mock-bank/internal/timeutil

- target: $..[*][?(@.pattern == "^(?!\s)[\w\W\s]*[^\s]$")]
  update:
    pattern: '^\S(?:[\s\S]*\S)?$'

- target: $.components.responses[*].headers.x-fapi-interaction-id
  remove: true

- target: $.components.responses[*].headers.x-v
  remove: true

- target: $.components.parameters.xIdempotencyKey.schema.pattern
  remove: true

- target: $.paths./portabilities.post.requestBody.content.application/jwt
  remove: true
- target: $.paths./portabilities.post.requestBody.content
  update:
    application/json:
      schema:
        $ref: '#/components/schemas/RequestCreditPortability'

- target: $.paths./portabilities/{portabilityId}/cancel.patch.requestBody.content.application/jwt
  remove: true
- target: $.paths./portabilities/{portabilityId}/cancel.patch.requestBody.content
  update:
    application/json:
      schema:
        $ref: '#/components/schemas/RequestCreditPortabilityCancel'

- target: $.paths./portabilities/{portabilityId}/payment.post.requestBody.content.application/jwt
  remove: true
- target: $.paths./portabilities/{portabilityId}/payment.post.requestBody.content
  update:
    application/json:
      schema:
        $ref: '#/components/schemas/RequestCreditPortabilityPayment'

- target: $.components.responses.POSTResponseCreditPortability.content.application/jwt
  remove: true
- target: $.components.responses.POSTResponseCreditPortability.content
  update:
    application/json:
      schema:
        $ref: '#/components/schemas/POSTResponseCreditPortability'

- target: $.components.responses.OKResponsePortabilityEligibility.content.application/jwt
  remove: true
- target: $.components.responses.OKResponsePortabilityEligibility.content
  update:
    application/json:
      schema:
        $ref: '#/components/schemas/ResponsePortabilityEligibility'

- target: $.components.responses.OKResponsePortabilitiesByPortabilityId.content.application/jwt
  remove: true
- target: $.components.responses.OKResponsePortabilitiesByPortabilityId.content
  update:
    application/json:
      schema:
        $ref: '#/components/schemas/ResponsePortabilitiesByPortabilityId'

- target: $.components.responses.OKResponseAccountData.content.application/jwt
  remove: true
- target: $.components.responses.OKResponseAccountData.content
  update:
    application/json:
      schema:
        $ref: '#/components/schemas/ResponseAccountData'

- target: $.components.responses.PatchResponseCreditPortabilityCancel.content.application/jwt
  remove: true
- target: $.components.responses.PatchResponseCreditPortabilityCancel.content
  update:
    application/json:
      schema:
        $ref: '#/components/schemas/PatchResponseCreditPortabilityCancel'

- target: $.components.responses.POSTResponseCreditPortabilityPayment.content.application/jwt
  remove: true
- target: $.components.responses.POSTResponseCreditPortabilityPayment.content
  update:
    application/json:
      schema:
        $ref: '#/components/schemas/POSTResponseCreditPortabilityPayment'
